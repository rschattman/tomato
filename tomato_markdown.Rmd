---
title: "Tomato nutrient study correlations"
author: "Rachel Schattman and Becky Maden"
date: "November 7, 2018"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load library
```{r}
library(dplyr)
```

## Start script


```{r}
script_path <- "C:/Users/rschattman/Documents/Research/Greenhouse_tomatoes_2018"
in_dir <- "C:/Users/rschattman/Documents/Research/Greenhouse_tomatoes_2018"
out_dir <- "C:/Users/rschattman/Documents/Research/Greenhouse_tomatoes_2018/output"
data <- data.frame(read.csv("C:/Users/rschattman/Documents/Research/Greenhouse_tomatoes_2018/Nutrient_levels_NH_VT_MA_11_14_18.csv"))
```

# Nitrate
## Create dataframe w/variables of interest for Nitrate only, omit rows with NA


```{r}

tomatofun_nitrate <- subset(data, select = c("Nitrate.N..ppm..SME", "Nitrate.N..ppm..MM", "TN.....Leaf.Analysis"))
tomatofun_nitrateNONA <- na.omit(tomatofun_nitrate) 

```

## Check distribution - all are non normal

```{r}
shapiro.test(tomatofun_nitrateNONA$Nitrate.N..ppm..SME)
shapiro.test(tomatofun_nitrateNONA$Nitrate.N..ppm..MM)
shapiro.test(tomatofun_nitrateNONA$TN.....Leaf.Analysis)
```
## Correlation tests

```{r}

cor(tomatofun_nitrateNONA, method = "spearman")

cor.test(x = tomatofun_nitrateNONA$Nitrate.N..ppm..SME, y = tomatofun_nitrateNONA$Nitrate.N..ppm..MM, alternative = "two.sided", method = "spearman", exact = NULL)
cor.test(x = tomatofun_nitrateNONA$Nitrate.N..ppm..SME, y = tomatofun_nitrateNONA$TN.....Leaf.Analysis, alternative = "two.sided", method = "spearman", exact = NULL)
cor.test(x = tomatofun_nitrateNONA$Nitrate.N..ppm..MM, y = tomatofun_nitrateNONA$TN.....Leaf.Analysis, alternative = "two.sided", method = "spearman", exact = NULL)

```
## plot SME and MM correlations
```{r}

plot(tomatofun_nitrateNONA$Nitrate.N..ppm..SME, tomatofun_nitrateNONA$Nitrate.N..ppm..MM, type = "p", main = "Nitrate SME and MM, p < 0.001", xlab = "SME PPM", ylab = "MM PPM")
abline(lm(tomatofun_nitrateNONA$Nitrate.N..ppm..SME~tomatofun_nitrateNONA$Nitrate.N..ppm..MM), col = "red") # regression line
```
# Phosphorus
## Create dataframe w/variables of interest for P only, omit rows with NA

```{r}
tomatofun_P <- subset(data, select = c("Phosphorus..ppm..SME", "Phosphorus..lb.Ac..MM", "P.....Leaf.Analysis"))
tomatofun_P_NONA <- na.omit(tomatofun_P) 

```

## Check distribution 

```{r}
shapiro.test(tomatofun_P_NONA$Phosphorus..ppm..SME)
shapiro.test(tomatofun_P_NONA$Phosphorus..lb.Ac..MM)
shapiro.test(tomatofun_P_NONA$P.....Leaf.Analysis)
```

## Correlation tests

```{r}

cor(tomatofun_P_NONA, method = "spearman")

cor.test(x = tomatofun_P_NONA$Phosphorus..ppm..SME, y = tomatofun_P_NONA$Phosphorus..lb.Ac..MM, alternative = "two.sided", method = "spearman", exact = NULL)
cor.test(x = tomatofun_P_NONA$Phosphorus..ppm..SME, y = tomatofun_P_NONA$P.....Leaf.Analysis, alternative = "two.sided", method = "spearman", exact = NULL)
cor.test(x = tomatofun_P_NONA$Phosphorus..lb.Ac..MM, y = tomatofun_P_NONA$P.....Leaf.Analysis, alternative = "two.sided", method = "spearman", exact = NULL)

```

## plot SME and MM correlations
```{r}

plot(tomatofun_P_NONA$Phosphorus..ppm..SME, tomatofun_P_NONA$Phosphorus..lb.Ac..MM, type = "p", main = "Phosphorus SME and MM, p < 0.001", xlab = "MM PPM", ylab = "SME PPM")
abline(lm(tomatofun_P_NONA$Phosphorus..lb.Ac..MM~tomatofun_P_NONA$Phosphorus..ppm..SME), col = "red") # regression line
```

# Potassium
## Create dataframe w/variables of interest for P only, omit rows with NA
head(data)

```{r}
tomatofun_K <- subset(data, select = c("Potassium..ppm..SME", "Potassium..lb.Ac..MM", "K.....Leaf.Analysis"))
tomatofun_K_NONA <- na.omit(tomatofun_K) 

```

## Check distribution 

```{r}
shapiro.test(tomatofun_K_NONA$Potassium..ppm..SME)
shapiro.test(tomatofun_K_NONA$Potassium..lb.Ac..MM)
shapiro.test(tomatofun_K_NONA$K.....Leaf.Analysis)
```

```{r}

cor(tomatofun_K_NONA, method = "spearman")

cor.test(x = tomatofun_K_NONA$Potassium..ppm..SME, y = tomatofun_K_NONA$Potassium..lb.Ac..MM, alternative = "two.sided", method = "spearman", exact = NULL)
cor.test(x = tomatofun_K_NONA$Potassium..ppm..SME, y = tomatofun_K_NONA$K.....Leaf.Analysis, alternative = "two.sided", method = "spearman", exact = NULL)
cor.test(x = tomatofun_K_NONA$Potassium..lb.Ac..MM, y = tomatofun_K_NONA$K.....Leaf.Analysis, alternative = "two.sided", method = "spearman", exact = NULL)

```

## plot SME and MM correlations
```{r}

plot(tomatofun_K_NONA$Potassium..ppm..SME, tomatofun_K_NONA$Potassium..lb.Ac..MM, type = "p", main = "Potassium SME and MM, p < 0.001", xlab = "MM PPM", ylab = "SME PPM")
abline(lm(tomatofun_K_NONA$Potassium..lb.Ac..MM~tomatofun_K_NONA$Potassium..ppm..SME), col = "red") # regression line
```

# P SME and pH MM
## Create dataframe w/variables of interest, omit rows with NA
head(data)
```{r}
tomatofun_P_pH <- subset(data, select = c("Phosphorus..ppm..SME", "Soil.pH"))
tomatofun_P_pH_NONA <- na.omit(tomatofun_P_pH) 
```

```{r}

cor(tomatofun_P_pH_NONA, method = "spearman")

cor.test(x = tomatofun_P_pH_NONA$Phosphorus..ppm..SME, y = tomatofun_P_pH_NONA$Soil.pH, alternative = "two.sided", method = "spearman", exact = NULL)

plot(tomatofun_P_pH_NONA$Phosphorus..ppm..SME, tomatofun_P_pH_NONA$Soil.pH, type = "p", main = "Phosphorus SME and pH, p < 0.001", xlab = "pH", ylab = "SME PPM")
abline(lm(tomatofun_P_pH_NONA$Soil.pH~tomatofun_P_pH_NONA$Phosphorus..ppm..SME), col = "red") # regression line
```